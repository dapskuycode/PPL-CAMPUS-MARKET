generator client {
  provider = "prisma-client"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  idUser            Int       @id @default(autoincrement())
  nama              String   @db.VarChar(255)
  noHP              String   @db.VarChar(20)
  email             String   @unique @db.VarChar(255)
  alamatJalan       String   @db.VarChar(255)
  rt                String   @db.VarChar(10)
  rw                String   @db.VarChar(10)
  namaKelurahan     String   @db.VarChar(100)
  kabupatenKota     String   @db.VarChar(100)
  provinsi          String   @db.VarChar(100)
  noKtp             String?   @db.VarChar(30)
  fotoKtp           String?   @db.VarChar(255)
  fileUploadKtp     String?   @db.VarChar(255)
  statusVerifikasi  String?   @db.VarChar(20)
  tanggalVerifikasi DateTime? @db.Timestamp(6)
  statusAkun        String?   @db.VarChar(20)
  tanggalDaftar     DateTime? @default(now()) @db.Timestamp(6)
  role              String?   @db.VarChar(50)

  product           Product[] @relation("SellerProducts")
  toko              Toko?     @relation
}

model Toko {
  idToko          Int      @id @default(autoincrement())
  namaToko        String   @db.VarChar(255)
  idSeller        Int      @unique
  deskripsiSingkat String?

  seller          User     @relation(fields: [idSeller], references: [idUser])
}

model Category {
  idCategory   Int       @id @default(autoincrement())
  namaKategori String    @db.VarChar(255)

  product      Product[]
}

model Product {
  idProduct     Int       @id @default(autoincrement())
  idSeller      Int
  idCategory    Int?
  namaProduk    String    @db.VarChar(255)
  deskripsi     String?
  harga         Decimal   @db.Decimal(15, 2)
  stok          Int?      @default(0)
  berat         Decimal?  @db.Decimal(10, 2)
  kondisi       String?   @db.VarChar(10)
  lokasi        String?   @db.VarChar(255)
  tanggalUpload DateTime? @default(now()) @db.Timestamp(6)
  statusProduk  String?   @default("aktif") @db.VarChar(20)

  seller       User?      @relation("SellerProducts", fields: [idSeller], references: [idUser], onDelete: Cascade)
  category     Category?  @relation(fields: [idCategory], references: [idCategory])
  productImage ProductImage[]
  rating       Rating[]
}

model ProductImage {
  idImage    Int      @id @default(autoincrement())
  idProduct  Int
  namaGambar String   @db.VarChar(255)
  urutan     Int?

  product    Product  @relation(fields: [idProduct], references: [idProduct], onDelete: Cascade)
}

model Rating {
  idRating      Int       @id @default(autoincrement())
  idProduct     Int
  namaPengunjung String   @db.VarChar(255)
  email         String?   @db.VarChar(255)
  noHP          String?   @db.VarChar(20)
  komentar      String?
  nilai         Int?
  tanggal       DateTime? @default(now()) @db.Timestamp(6)

  product       Product   @relation(fields: [idProduct], references: [idProduct], onDelete: Cascade)
}
